【タイトル】
第1話 アプリにイースターエッグを仕込んでみたのだけど

【公開状態】
公開済

【作成日時】
2021-06-28 16:34:57（+09:00）

【公開日時】
2021-06-28 17:52:52（+09:00）

【更新日時】
2021-06-28 17:52:52（+09:00）

【文字数】
4,893文字

【本文（317行）】
　高校二年の僕、｜新山修太《あらやましゅうた》には気になる女性がいる。
　名を｜桂美里《かつらみさと》と言って、腐れ縁と言ってもいい仲だ。
　ただ、友達としての関係が続き過ぎて、仲はいいけどあと一歩が踏み出せない。

　そこで僕はスマホアプリを作る特技を生かした策を思いついた。
　それは、相性診断アプリを開発して広めること。
　もちろん、結果は機械学習などを駆使して、精度もそれなりになるようにした。
　そして、これが一番重要な事なのだけど―
　僕の名前と美里の名前を入力すると、相性度が100%になるのだ。

（僕も大概馬鹿なことをしているよな）

　いわゆるイースターエッグという奴で、開発者が秘密のメッセージや隠し機能を
　作り込むというものだ。
　そんな遠回りなことをするくらいなら、さっさと告白でもすればいいんだろう。
　ただ、玉砕したら美里と気まずくなる。それは嫌だったんだ。

　幸い、リリースしたアプリ『AIでわかる相性診断』は10万ダウンロードを達成。
　ちなみに、デザインやメッセージには美里も協力してもらっている。
　男の僕よりも、診断結果のメッセージはいい案があるだろうと思ったのだ。

「にしても、修太は相変わらず凄いねー。もう、学校中で大流行だよ！」

　嬉しそうな顔をしてはしゃいでいる美里が微笑ましい。
　学校に広めるのには、口コミで美里にも協力してもらった。

「まあ、これくらいしか特技がないし。で、クラスの反応はどう？」

　美里と僕は隣のクラスだ。だから、反応が少し気になった。

「結構好評だよー。やっぱり同性でも診断出来るようにしたのは良かったね」
「異性だと躊躇する子もいるだろうしね」

　つまり、恋愛のみでなく、友達同士の相性診断にも使える。
　なお、名前だけでなく、趣味や嗜好に関する質問にも答えてもらう。
　ただ、情報はアプリからは送信しないとあって、安心して使ってもらえている。

「でもさー。結局、なんで急に相性診断アプリなんてリリースしたの？」

　う。そこを突いて来るか。

「ちょっとAIプログラミングの練習をしたかっただけ」
「ふーん。なんか妙な気がするけど」

　さすがに鋭い。言い訳は端から信じていないらしい。

「ところでさ。せっかくだし、僕と―」

　美里とで試しに相性診断してみない？
　と言うつもりだった。
　もちろん、100%だったからどうというわけじゃない。
　ただ、「やっぱり、私達って相性いいじゃん」とか。
　あるいは、そこから少しでも意識してもらえればと思っていた。

　なのに―

「ねえねえ。修太と私で診断してみない？」

　妙ににこやかな顔でそんな提案をされてしまう。
　ええ？それは想定外だ。
　美里も僕との相性が気になっているんだろうか。
　ともあれ、僕から言わなくていいので好都合だ。

「じゃあ、まず名前入力からね。あらやましゅうた、と」

　漢字にすると異字体とかややこしいので、入力はひらがなだ。

「私は、かつらみさと、でいいんだよね？」
「あ、うん。それで大丈夫」

　本名を想定しているだけに、あだ名を入力されたら危ういところだった。
　
「かつらみさと、と。好きな料理、か」

　相性診断のために、好きな料理、趣味、休日の過ごし方などを入れてもらう。
　趣味や料理同士の「距離」を算出して、相性度を算出するアルゴリズムだ。
　たとえば、納豆が好きと、豆腐が好きは距離が近いと言った具合だ。
　その他にも、趣味同士の相関関係をアプリには予め学習させてある。
　ともあれ、今回に限っては全く関係がないのだけど。

「結構、質問が多いね。もうちょっと簡略化出来なかったの？」

　質問は計20問ある。正直、ちょっと多過ぎという苦情はわかる。
　ただ、質問を増やした方がより正確な相性を測れるのだ。

「まあ、正確な相性を測るためってことで、我慢してよ。ね？」

　とはいえ、今回に限ってはやっぱり意味がないのだけど。
　だって、結果は100%に決まっているのだ。

「しょーがないか」

　ふんふんふふーんと次々と質問に答えていく美里。

「入力全部終わったよー」
「じゃあ、後は結果待ちだね。10秒くらいで出るとおもうけど」

　もっとも、隠し機能だから、計算しているフリなのだけど。

「どんな結果が出るかなー。楽しみー」

　ワクワクしたように言う美里。
　そんなに、僕との相性が気になるんだろうか。

「あ、出た出た！0%だって！」

　え？
　笑顔で報告する美里を見て、僕は開いた口が塞がらなかった。

「ぜ、0%？さすがに、そんな数字滅多に出ないはずだけど」

　それ以前に、ちゃんと名前は正確なのに、なんで100%じゃないの？

「ふーん。修太ってば動揺してるんだー」

　ニヤニヤ笑いの美里。

「い、いや。予想外だから、デバッグしないと、って思ってただけ」

　いや、本当になんでこんなことに？
　名前が半角になっていたとかで結果がずれた？
　いや、それにしても0%なんて極端な結果はそうそう出ないはず。

「ふーん。デバッグかあ。治るといいね？」
　
　何故かやたら美里はご機嫌だけど、何が嬉しいのだろうか？

「ちょっと待ってて。僕は作業するから、美里はそこで座っといて」

　僕のベッドの縁を指差す。

「うん。ごゆっくりー」

　それっきり、スマホを弄りはじめて僕への興味を失ったらしい。

「で、一体全体どうして……」

　｜統合開発環境《とうごうかいはつかんきょう》を立ち上げる。
　まず、イースターエッグを埋め込んだソースコードを見ないと。

「え？」

　そこに表示されていたのは驚くべき結果だった。

「なになに、何かわかった？」

　興味津々という様子の美里。

「あ、いや。デバッグビルドとリリースビルドで微妙に違う……」

　言葉を濁したけど、

fun calculateScore(myName: String, yourName: String): Int {
　if(myName == "あらやましゅうた" && yourName == "かつらみさと") {
　　if (IS_RELEASE_BUILD) {
　　　return 0
　　} else {
　　　return 100
　　}
　} else {
　　return calculateScoreInNormalMode(myName, yourName)
　}
}

　僕と美里の名前が入力された時、デバッグビルドでは相性値が100。
　リリースビルドでは相性値が0になるコードが追加されていた。
　配布されているアプリはリリースビルドだ。
　いや、しかし。

「僕はこんなコード入れた覚えないぞ？」

　身に覚えの無いコードに混乱の極地だ。
　誰かが別のコードを混入した？
　しかし、これのソースは公開してないはず。
　もし出来るとしたら―
　
　振り向くと、美里がにっこりと満面の笑みだった。
　まさか美里がそんな。
　確かにアプリを組んでいる時に、母さんに呼ばれて席を外したことはあった。
　美里ならこのコードを仕込む事は可能だ。

「ねえ、このコードを仕込んだのはひょっとして、美里？」
「このコードって何かな？」

　くう。ニヤニヤ笑いが憎々しい。これで犯人はほぼ確定。

「つまりその。イースターエッグだよ」

　仕込んだものそのものを言うのははばかられた。

「へー。修太はどんなイースターエッグを仕込んだの？」

　こいつ、悪魔だ。わかってて白状させようとしている。

「お前と僕の名前を入れると……相性度が100%になるの、だよ」

　自然と最後の方は声が小さくなってしまう。
　もう、最悪だ。
　幸い、美里は怒ってはいないけど、おもちゃにされるのは間違いない。
　わざわざ0%にするなんて悪戯をするくらいだ。

「でも、どうやっていれたのさ。Gitの履歴には妙なのは無かったはず」
「修太らしくもないね。Gitはrebaseが出来るのを忘れたの？」
「ああ。そういうことか」

　今どきのプログラマはソースコードをVCSと呼ばれるソフトで管理している。
　要は変更履歴を保存しておいて、差分を見たり、過去に巻き戻したり出来るのだ。
　Gitはその中でもメジャーなものの一つなのだけど、特徴的な機能がある。
　rebaseと呼ばれる、変更履歴を改変する機能があるのだ。
　席を外している間にrebaseで履歴を改変して何食わぬ顔で待っていたのだ。
　僕が変更した履歴と、彼女が入れ込んだ変更を一つの履歴に混ぜてしまえば、
　簡単には気づけない。

「とにかく、種明かしはわかったよ。で、僕をからかいたかっただけ？」

　言いつつ、ショックを感じている自分が居るのを感じる。
　わざわざ相性度を0%にするということは気がないという事の表明だろう。

「逆だよ、逆。その後に出てるメッセージ読んでみて？」
「うん？」

　確かに、相性度表示の後に出るメッセージがあった。
　0%の場合「あなたと彼女の相性は絶望的です。諦めて新しい恋を探しましょう」
　という、ちょっとアレなメッセージが表示される仕様になっている。
　まあ、まずないからふざけたメッセージにしたのだけど。

　と、メッセージを読んでいくにつれ、顔がどんどん赤くなっていくのを感じる。

『まずは、変なイタズラしちゃってごめんね♪
　私も修太との仲をどう進めていいかわからなかったから、最近色々考えてたんだ。
　それで、ちょうどいい所に修太が細工してるのがわかったの。
　正直、すっごく嬉しかった。こんな事する程好きで居てくれるなんて。
　だって、私も修太のこと大好きだったから。
　せっかくだから、ちょっとしたイタズラを仕掛けてみることにしちゃった。
　0%なのは、修太の落ち込む顔を見てみたかったからだけどね。
　でも、私としては相性度は100%のつもりだから落ち込まないでね。
　これからは恋人としてよろしくね❤

　昔からの親友　美里より』

　やられた。
　僕が彼女のことを意識していたように、彼女も色々考えていたのだ。
　しかも、直球の告白まで仕込んで。

「あのさ。美里……その。ありがとう」
「う、うん。やっぱりちょっと恥ずかしいね」

　さすがに告白のメッセージを間近で読まれては恥ずかしいらしい。
　セミロングの茶髪をいじいじしている様が可愛らしい。

「じゃあその。改めて。僕もずっと好きだったよ、美里」

　結局、彼女に先に告白させてしまったけど。
　きちんと僕も言葉にして伝えないと。

「うん。私も大好き！」

　飛び込むように抱きつかれて、身体が熱く感じる。
　
「ちなみにさ。美里はいつから僕の事を？」
「んー。夢中でキーボード叩いてる姿がカッコよくて、かな？」
「別にそんなに格好良くないとおもうんだけど」

　と言いつつ、そう言われて悪い気はしない。

「私が格好いいと思ったから良いの！それで、修太は？」
「以前に初めて合作でプログラム書いただろ。妙に意識してしまって。それ以来」

　今が高二の夏で、確かあれは中学三年の頃だったか。

「そっかー。あれで意識しちゃったんだー」

　美里はさっきまでのニヤニヤと違って、ただただ幸せそうだ。

「だって……その、胸とか当たるし、体温とかも……」

　あれは本当に恥ずかしかった。
　普段、あんまり触れ合わないだけに余計に意識してしまった。

「実は、私もあれで意識してくれないかなーって思ってたんだけど。そっか、そっかー。うまく行ってたのかー」
「くう。この策士め」

　とはいえ、あの時も今回も踊らされてしまったのだから、文句は言えない。

「修太が油断し過ぎなんだよ。いくら私でも画面ロックくらいしないと」
「これからはそうするよ。今回は助けられたけど」

　また、妙なイタズラを仕掛けられてはたまったものじゃない。

「でも、これで晴れて恋人同士だね。うーん、幸せ」
「僕も幸せだけど……。抱き合ってるの恥ずかしい」
「私は幸せなだけだけどなー？」
「……まあいいや」

　こうして、僕と彼女はひょんなきっかけで恋人になってしまったのだった。

「あ、でも！相性診断アプリ、私も本格的に関わらせて欲しい！」
「別にいいけど。何がしたいの？」
「クラスでなんか煮え切らない子たち居るでしょ。そうこと」
「なるほど。恋のキューピッドというやつね」
「そうそう。面白そうじゃない？」
「本当に、昔からイタズラ好きなんだから」

　ため息をつきつつも、幸せな気持ちだ。

「イタズラ好きなのは嫌？」
「わかってるでしょ」
「でも、言って欲しい」
「そんな所も好きだよ」
「私も。そんな風に笑って許してくれるところ、大好き！」

　うう。胸が押し付けられる。
　ほんと、美里は本当に無邪気というかなんというか。
　これからも僕は彼女に振り回されていくんだろうか。
　しかし―
　策士策に溺れるという奴だけど、良い結果になったのだし、いいか。

